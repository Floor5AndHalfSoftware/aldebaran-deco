"use strict";
// Array di configurazione del service worker

let config = {
  version: "2.29",
  //Risorse da inserire in cache immediatamente - Precaching
  staticCacheItems: [
    //JS
    "/js/axios.min.js",
    "/js/bootstrap.min.js",
    "/js/counter.js",
    "/js/custom.js",
    "/js/httpVueLoader.min.js",
    "/js/jquery-3.2.1.min.js",
    "/js/jquery-3.3.1.min.js",
    "/js/jquery-migrate-3.0.0.min.js",
    "/js/jquery-ui.min.js",
    "/js/jquery.countdown.min.js",
    "/js/jquery.event.move.js",
    "/js/jquery.steps.js",
    "/js/jquery.touchSwipe.min.js",
    "/js/jquery.ui.touch-punch.min.js",
    "/js/menu-opener.js",
    "/js/menu.js",
    "/js/popper.min.js",
    "/js/slick.min.js",
    "/js/SmoothScroll.js",
    "/js/vue-router.min.js",
    "/js/vue-slider-component.umd.min.js",
    "/js/vue.min.js",
    "/js/vuex.min.js",
    "/js/waypoints.js",
    "/js/YouTubePopUp.jquery.js",
    //CSS
    "/css/animate.min.css",
    "/css/bootstrap.min.css",
    "/css/flaticon.css",
    "/css/font-awesome.min.css",
    "/css/magnific-popup.css",
    "/css/menu.css",
    "/css/responsive.css",
    "/css/slick.css",
    "/css/style.css",
    "/css/vue-slider-component.umd.css",
    "/css/vue2-editor.css",
    "/css/YouTubePopUp.css",
    //font
    "/font/Montserrat-Medium.ttf",
    "/font/Overpass-Light.ttf",
    "/font/Montserrat-SemiBold.ttf",
    "/font/Overpass-Bold.ttf",
    "/font/Flaticon.ttf",
    "/font/Montserrat-ExtraBoldItalic.ttf",
    "/font/Flaticon.svg",
    "/font/_flaticon.scss",
    "/font/Overpass-Regular.ttf",
    "/font/Montserrat-Regular.ttf",
    "/font/flaticon.css",
    "/font/Montserrat-Bold.ttf",
    "/font/Righteous-Regular.ttf",
    "/font/Flaticon.eot",
    "/font/flaticon.html",
    "/font/Overpass-Medium.ttf",
    "/font/Overpass-ExtraBold.ttf",
    "/font/Flaticon.woff",
    "/font/Comfortaa-Regular.ttf",
    "/font/Flaticon.woff2",
    //images
    "/images/banner-background.jpg",
    "/images/background-casino.jpg",
    "/images/profile_documento_icon.png",
    "/images/banner-altenar-right-side-1.jpg",
    "/images/facilito.jpg",
    "/images/left_arrow.png",
    "/images/profile_avatar.png",
    "/images/banner-background-2-old.jpg",
    "/images/rocket.png",
    "/images/banner-background-3.jpg",
    "/images/mastercard.png",
    "/images/bingo1.png",
    "/images/faq-page-border.png",
    "/images/Nuvei_Organization_logo.png",
    "/images/paycash.png",
    "/images/games_pragmatic.svg",
    "/images/header-background.png",
    "/images/visa-mastercard1.png",
    "/images/games_megaways.svg",
    "/images/running-jackpot-1.jpg",
    "/images/header-logo2.png",
    "/images/upcomming-jackpot-2.jpg",
    "/images/related-game-image-7.jpg",
    "/images/footer_logo_.png",
    "/images/image_next.png",
    "/images/games_exclusive.png",
    "/images/country5.png",
    "/images/venta-info-del-jugador.png",
    "/images/games_slot.svg",
    "/images/games_video-slots.png",
    "/images/heading-border-effect.png",
    "/images/white-x.png",
    "/images/header-background-info.jpg",
    "/images/cruz_azul.png",
    "/images/gana_aqui.png",
    "/images/puntodelasuerte.jpg",
    "/images/profile-banner.png",
    "/images/flag-uk.png",
    "/images/Aucas.png",
    "/images/games_popular.png",
    "/images/visa_maste.png",
    "/images/tiktok.png",
    "/images/loteria.jpg",
    "/images/running-jackpot-2.jpg",
    "/images/related-game-image-4.jpg",
    "/images/games_default.svg",
    "/images/check.png",
    "/images/Emelec.png",
    "/images/banner-mobile-2.jpg",
    "/images/banner-altenar-right-side-3.png",
    "/images/banner-altenar-right-side-2.jpg",
    "/images/logo_bemovil.png",
    "/images/related-game-image-5.jpg",
    "/images/tarjete-efectivo.png",
    "/images/running-jackpot-3.jpg",
    "/images/imagen-parallax.png",
    "/images/yellow-instagram.png",
    "/images/about-video-image.jpg",
    "/images/share_ios.png",
    "/images/mail_letter.png",
    "/images/upcomming-jackpot-3.jpg",
    "/images/banner-games-1.png",
    "/images/jugar.jpg",
    "/images/banner-mobile-1.jpg",
    "/images/Nuvei_Logo_2022.png",
    "/images/games_instant.png",
    "/images/white-facebook.png",
    "/images/instagram.png",
    "/images/carton-y-bolas.png",
    "/images/puntodelasuerte.png",
    "/images/email-logo.png",
    "/images/games_video-poker.svg",
    "/images/page-background-3.jpg",
    "/images/loteria.png",
    "/images/banco pichincha.png",
    "/images/tarjete-bancaria.png",
    "/images/paycash.svg",
    "/images/nuvei.png",
    "/images/tarjete-place-to-pay.png",
    "/images/venta-que-puede-hacer-el-jugador.png",
    "/images/games_cartas.png",
    "/images/free-spin-image.png",
    "/images/do-3.png",
    "/images/header-logo.jpg",
    "/images/nico.png",
    "/images/background-casino.png",
    "/images/Macara.png",
    "/images/loading_slot.gif",
    "/images/banner-background-2.jpg",
    "/images/related-game-image-8.jpg",
    "/images/country1.png",
    "/images/background-casino.svg",
    "/images/profile_icon_dinero.png",
    "/images/banco guayaquil.png",
    "/images/login_to_play.jpg",
    "/images/logo-metronia.png",
    "/images/western-union.png",
    "/images/banner-background-1.jpg",
    "/images/share_ios_1.png",
    "/images/footer_email.jpg",
    "/images/visa-mastercard.png",
    "/images/flag-es.png",
    "/images/taunament-border.png",
    "/images/games_video-poker.png",
    "/images/games_all.svg",
    "/images/other-nav-bg.png",
    "/images/mobile_arrow_right.png",
    "/images/no-results.png",
    "/images/banco_guayaquil.png",
    "/images/banner-games.png",
    "/images/twitter.png",
    "/images/Cuenca.png",
    "/images/dispobleappActive.png",
    "/images/visa.png",
    "/images/logo_email.png",
    "/images/banner-background.png",
    "/images/not-found.png",
    "/images/12cartones.png",
    "/images/upcomming-jackpot-1.jpg",
    "/images/country2.png",
    "/images/profile_maps_icon.png",
    "/images/games_roulette.png",
    "/images/banner-altenar-left-side-5.png",
    "/images/profile_phone_icon.png",
    "/images/premio.png",
    "/images/faq-border-2.png",
    "/images/banco_pichincha.jpg",
    "/images/ruleta-hover.gif",
    "/images/BETNEFICIOS-ICON.gif",
    "/images/games_cartas.svg",
    "/images/email-banner.jpg",
    "/images/logobet593.png",
    "/images/arrow-mas.png",
    "/images/juegos-online.png",
    "/images/games_live.png",
    "/images/facebook.png",
    "/images/Personalizacion-del-juego.png",
    "/images/games_halloween.png",
    "/images/torneoslots2.jpg",
    "/images/button-mas.png",
    "/images/games_exclusivas.svg",
    "/images/faq-border.png",
    "/images/match-card-background.jpg",
    "/images/mouse.png",
    "/images/profile-lateral.png",
    "/images/juego-info-para-el-jugador.png",
    "/images/games_slot.png",
    "/images/yellow-x.png",
    "/images/games_default.png",
    "/images/yellow-down-arrow.png",
    "/images/related-game-image-1.jpg",
    "/images/banner-altenar-left-side-4.png",
    "/images/contact-bg-image.jpg",
    "/images/profile_gift_icon.png",
    "/images/404-image.jpg",
    "/images/red_ws.png",
    "/images/banner-background-1-old.jpg",
    "/images/white-instagram.png",
    "/images/fondo-2.png",
    "/images/3cartones.png",
    "/images/country3.png",
    "/images/related-game-image-3.jpg",
    "/images/logo-modal-header.png",
    "/images/new.jpg",
    "/images/diners.png",
    "/images/games_new.svg",
    "/images/header-background.jpg",
    "/images/iniciar_sesion.png",
    "/images/zona-de-compra.png",
    "/images/games_instant.svg",
    "/images/games_navidad.png",
    "/images/banner-background-old.png",
    "/images/usuario.png",
    "/images/Manta.png",
    "/images/mi_comisariato.png",
    "/images/mobile_dollars.png",
    "/images/favicon.png",
    "/images/tarjete.png",
    "/images/placetopay.png",
    "/images/LogosGCFC.png",
    "/images/yellow-facebook.png",
    "/images/loteria-header.png",
    "/images/banner-mobile-3.jpg",
    "/images/payphone_footer.png",
    "/images/games_virtuals.svg",
    "/images/retirada-efectivo.png",
    "/images/country4.png",
    "/images/games_quick.png",
    "/images/games_bingo.png",
    "/images/games_bingo.svg",
    "/images/bank-transfer.png",
    "/images/bonobet593.jpg",
    "/images/banner-altenar-left-side-2.png",
    "/images/related-game-image-2.jpg",
    "/images/tia.png",
    "/images/extraccion-de-bolas.png",
    "/images/games_roulette.svg",
    "/images/basketball.png",
    "/images/header-logo.png",
    "/images/page-background-1.jpg",
    "/images/Barcelona.png",
    "/images/dispobleappHover.png",
    "/images/banner-altenar-left-side-3.png",
    "/images/ruleta.gif",
    "/images/banner-background-mobile.png",
    "/images/banner-mobile.jpg",
    "/images/related-game-image-9.jpg",
    "/images/diners.jpg",
    "/images/youtube.png",
    "/images/flag-pr.png",
    "/images/tarjete-comisariato.png",
    "/images/logotipo-animazione.gif",
    "/images/new.png",
    "/images/games_new.png",
    "/images/related-game-image-6.jpg",
    "/images/header-logo_.png",
    "/images/games_special.png",
    "/images/logo-loteria.png",
    "/images/games_popular.svg",
    "/images/banner-sportsbook.png",
    "/images/banner-background-old.jpg",
    "/images/ligaprologo.png",
    "/images/red-activa.png",
    "/images/farmacia_911.png",
    "/images/close.webp",
    "/images/favicon_old.png",
    "/images/banner-altenar-left-side-1.png",
    "/images/border-effect.png",
    "/images/games_live casino.svg",
    "/images/torneoslots.jpg",
    "/images/retirada-bancaria.png",
    "/images/vecino-barro.png",
    "/images/logo-bet.png",
    "/images/profile_password_icon.png",
    "/images/footer_logo.png",
    "/images/page-background-2.jpg",
    "/images/x.png",
    "/images/juego-que-puede-hacer-el-jugador.png",
    "/images/payphone.png",
    "/images/games_all.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-256.png",
    "/images/launchericons/windows11/SplashScreen.scale-200.png",
    "/images/launchericons/windows11/SmallTile.scale-150.png",
    "/images/launchericons/windows11/SmallTile.scale-400.png",
    "/images/launchericons/windows11/Square44x44Logo.scale-150.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-16.png",
    "/images/launchericons/windows11/Wide310x150Logo.scale-125.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-48.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-40.png",
    "/images/launchericons/windows11/Square44x44Logo.scale-100.png",
    "/images/launchericons/windows11/Wide310x150Logo.scale-100.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-64.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-32.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-96.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-80.png",
    "/images/launchericons/windows11/Square150x150Logo.scale-125.png",
    "/images/launchericons/windows11/LargeTile.scale-100.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-36.png",
    "/images/launchericons/windows11/StoreLogo.scale-200.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-48.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-44.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-96.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-32.png",
    "/images/launchericons/windows11/Square44x44Logo.scale-125.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-48.png",
    "/images/launchericons/windows11/SplashScreen.scale-150.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-60.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-40.png",
    "/images/launchericons/windows11/Square150x150Logo.scale-200.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-256.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-60.png",
    "/images/launchericons/windows11/Wide310x150Logo.scale-400.png",
    "/images/launchericons/windows11/LargeTile.scale-125.png",
    "/images/launchericons/windows11/StoreLogo.scale-125.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-20.png",
    "/images/launchericons/windows11/StoreLogo.scale-150.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-72.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-40.png",
    "/images/launchericons/windows11/StoreLogo.scale-100.png",
    "/images/launchericons/windows11/SmallTile.scale-200.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-256.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-30.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-20.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-64.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-96.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-24.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-36.png",
    "/images/launchericons/windows11/SplashScreen.scale-125.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-64.png",
    "/images/launchericons/windows11/Square44x44Logo.scale-200.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-80.png",
    "/images/launchericons/windows11/Wide310x150Logo.scale-150.png",
    "/images/launchericons/windows11/LargeTile.scale-200.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-80.png",
    "/images/launchericons/windows11/SmallTile.scale-125.png",
    "/images/launchericons/windows11/SmallTile.scale-100.png",
    "/images/launchericons/windows11/Square150x150Logo.scale-100.png",
    "/images/launchericons/windows11/LargeTile.scale-400.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-30.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-72.png",
    "/images/launchericons/windows11/SplashScreen.scale-400.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-16.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-60.png",
    "/images/launchericons/windows11/LargeTile.scale-150.png",
    "/images/launchericons/windows11/Wide310x150Logo.scale-200.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-44.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-30.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-36.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-20.png",
    "/images/launchericons/windows11/Square150x150Logo.scale-400.png",
    "/images/launchericons/windows11/SplashScreen.scale-100.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-lightunplated_targetsize-24.png",
    "/images/launchericons/windows11/StoreLogo.scale-400.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-32.png",
    "/images/launchericons/windows11/Square150x150Logo.scale-150.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-72.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-24.png",
    "/images/launchericons/windows11/Square44x44Logo.targetsize-44.png",
    "/images/launchericons/windows11/Square44x44Logo.scale-400.png",
    "/images/launchericons/windows11/Square44x44Logo.altform-unplated_targetsize-16.png",
    "/images/launchericons/android/android-launchericon-512-512.png",
    "/images/launchericons/android/android-launchericon-48-48.png",
    "/images/launchericons/android/android-launchericon-96-96.png",
    "/images/launchericons/android/android-launchericon-192-192.png",
    "/images/launchericons/android/android-launchericon-144-144.png",
    "/images/launchericons/android/android-launchericon-72-72.png",
    "/images/launchericons/ios/152.png",
    "/images/launchericons/ios/100.png",
    "/images/launchericons/ios/50.png",
    "/images/launchericons/ios/58.png",
    "/images/launchericons/ios/80.png",
    "/images/launchericons/ios/29.png",
    "/images/launchericons/ios/60.png",
    "/images/launchericons/ios/114.png",
    "/images/launchericons/ios/120.png",
    "/images/launchericons/ios/87.png",
    "/images/launchericons/ios/76.png",
    "/images/launchericons/ios/16.png",
    "/images/launchericons/ios/128.png",
    "/images/launchericons/ios/167.png",
    "/images/launchericons/ios/20.png",
    "/images/launchericons/ios/512.png",
    "/images/launchericons/ios/64.png",
    "/images/launchericons/ios/40.png",
    "/images/launchericons/ios/180.png",
    "/images/launchericons/ios/32.png",
    "/images/launchericons/ios/192.png",
    "/images/launchericons/ios/144.png",
    "/images/launchericons/ios/72.png",
    "/images/launchericons/ios/57.png",
    "/images/launchericons/ios/256.png",
    "/images/launchericons/ios/1024.png",
    "/images/payment/payment-image-4.jpg",
    "/images/payment/multicaixa-express.png",
    "/images/payment/visa-diners-other.png",
    "/images/payment/payment-image-1.jpg",
    "/images/payment/Z MASTERCARD.png",
    "/images/payment/Z PAGO EFECTIVO.png",
    "/images/payment/internet-banking.png",
    "/images/payment/Z UNION PAY.svg.png",
    "/images/payment/multicaixa.png",
    "/images/payment/Z ALIA.png",
    "/images/payment/payment-image-2.jpg",
    "/images/payment/Z VISA.png",
    "/images/payment/placetopay_cards.png",
    "/images/payment/mastercard-logo.png",
    "/images/payment/Z AMEX.png",
    "/images/payment/payment-image-3.jpg",
    "/images/payment/placetopay.png",
    "/images/payment/proxypay.png",
    "/images/payment/payment-image-5.jpg",
    "/images/payment/Z DISCOVER.png",
    "/images/payment/nuvei_cards.png",
    "/images/payment/Z DINERS CLUB.png",
    /*
     */
  ],
};
// Funzione che restituisce una stringa da utilizzare come chiave per la cache
function cacheName(key, opts) {
  return `${opts.version}${key}`;
}

const CACHE_NAME = "aldebaran-cache";
const OFFLINE_URL = "offline.html";

self.addEventListener("install", (event) => {
  event.waitUntil(
    // Inserisco in cache le URL configurate in config.staticCacheItems
    caches
      .open(cacheName(CACHE_NAME, config))
      .then((cache) => {
        cache.addAll(config.staticCacheItems);
        cache.add(new Request(OFFLINE_URL, { cache: "reload" }));
      })
      // self.skipWaiting() evita l'attesa, il che significa che il service worker si attiverÃÂÃÂÃÂÃÂ  immediatamente non appena conclusa l'installazione
      .then(() => self.skipWaiting())
  );
  console.log("[sw] service worker installed");
});

self.addEventListener("activate", (event) => {
  // Questa funzione elimina dalla cache tutte le risorse la cui chiave non contiene il nome della versione
  // impostata sul config di questo service worker
  async function clearCacheIfDifferent(event, opts) {
    const cacheKeys = await caches.keys();
    let oldCacheKeys = cacheKeys.filter((key) => !key.startsWith(opts.version));
    let deletePromises = oldCacheKeys.map((oldKey) => caches.delete(oldKey));
    return await Promise.all(deletePromises);
  }

  event.waitUntil(
    // Se la versione del service worker cambia, svuoto la cache
    clearCacheIfDifferent(event, config)
      // Con self.clients.claim() consento al service worker di poter intercettare le richieste (fetch) fin da subito piuttosto che attendere il refresh della pagina
      .then(() => self.clients.claim())
  );
  console.log("[sw] service worker active");
});

self.addEventListener("fetch", (event) => {
  // We only want to call event.respondWith() if this is a navigation request
  // for an HTML page.
  if (event.request.mode === "navigate") {
    event.respondWith(
      (async () => {
        try {
          // First, try to use the navigation preload response if it's supported.
          const preloadResponse = await event.preloadResponse;
          if (preloadResponse) {
            return preloadResponse;
          }

          // Always try the network first.
          const networkResponse = await fetch(event.request);
          return networkResponse;
        } catch (error) {
          // catch is only triggered if an exception is thrown, which is likely
          // due to a network error.
          // If fetch() returns a valid HTTP response with a response code in
          // the 4xx or 5xx range, the catch() will NOT be called.
          console.log("Fetch failed; returning offline page instead.", error);

          const cache = await caches.open(cacheName(CACHE_NAME, config));
          const cachedResponse = await cache.match(OFFLINE_URL);
          return cachedResponse;
        }
      })()
    );
  }

  // If our if() condition is false, then this fetch handler won't intercept the
  // request. If there are any other fetch handlers registered, they will get a
  // chance to call event.respondWith(). If no fetch handlers call
  // event.respondWith(), the request will be handled by the browser as if there
  // were no service worker involvement.
});
